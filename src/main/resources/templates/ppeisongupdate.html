<!DOCTYPE html>
<html lang="en" xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
      layout:decorator="common/layout" xmlns:th="http://www.w3.org/1999/xhtml" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8"/>
    <title>AlphaZ</title>
    <link rel="stylesheet" href="resources/plugins/datatables/dataTables.bootstrap.css"/>
    <link rel="stylesheet" href="resources/plugins/bootstrap-select-1.12.4/css/bootstrap-select.min.css"/>
    <link rel="stylesheet" href="resources/plugins/sweetalert/sweetalert.css">
<!--    <link rel="stylesheet" href="resources/plugins/datepicker/datepicker3.css">-->
    <link rel="stylesheet" href="resources/plugins/dist/css/selectize.default.css">
    <link rel="stylesheet" href="resources/plugins/bootstrap-datetimepicker-master/css/bootstrap-datetimepicker.min.css">
</head>
<body>
<div layout:fragment="content">
    <section class="content-header">
        <h1>
            查看/编辑配送信息
            <small></small>
        </h1>
        <div class="dropdown" style="float: right;margin-top: -20px;margin-bottom: 5px;margin-right:5px;display: none;" id="toRetract">
            <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                驳回
                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="dropdownMenu1" id="reject">
                <li data-toggle="modal" data-target="#myModalRetract" data-click="0" data-no = "0"><a href="javascript:;">入库</a></li>
                <li data-toggle="modal" data-target="#myModalRetract" data-click="0" data-no = "1"><a href="javascript:;">盘货</a></li>
                <li data-toggle="modal" data-target="#myModalRetract" data-click="0" data-no = "2"><a href="javascript:;">审价</a></li>
                <li data-toggle="modal" data-target="#myModalRetract" data-click="0" data-no = "3"><a href="javascript:;">核价</a></li>
            </ul>
        </div>
        <button class="btn btn-primary" style="float: right;margin-top: -20px;margin-bottom: 5px;margin-right:5px;display: none;" id="toSubmit">保存并提交</button>
        <button class="btn btn-primary" style="float: right;margin-top: -20px;margin-bottom: 5px;margin-right:5px;display: none;" id="toupdate">编辑</button>
        <button class="btn btn-primary" style="float: right;margin-top: -20px;margin-bottom: 5px;margin-right:5px;display: none;" id="tosave">保存</button>
        <!--<button class="btn btn-primary" style="float: right;margin-top: -20px;margin-bottom: 5px;margin-right:5px;display: none;" id="toDelete">撤回</button>-->
    </section>
    <section class="content">
        <img class='img_close' src='resources/img/clone.png' style="display: none">
        <div class="row">
            <div class="col-xs-12">
                <div class="box">
                    <div class="box-header">
                        <h3 class="box-title">入库信息</h3>
                        <!--<ul class="nav navbar-right panel_toolbox">
                            <li><a href="tocargolist" style="margin-right:10px;"><i class="fa fa-arrow-left"></i>返回</a>
                            </li>
                        </ul>-->
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">
                        <input th:value="${hid}" id="hid" type="hidden">
                        <input th:value="${pagemsg}" id="pagemsg" type="hidden">
                        <input id="hhid" type="hidden">
                        <div class="row">
                            <div class="col-md-4 form-group">
                                <div class="input-group date">
                                    <div class="input-group-addon">
                                        <span>入库时间</span>
                                    </div>
                                    <input type="text" class="form-control pull-right disinp" placeholder="请选择入库时间" id="warehouseintime">
                                </div>
                            </div>
                            <div class="col-md-4 form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">仓库代码</span>
                                    <div style="height: 34px;"><input id="warehouseid" placeholder="请填写仓库代码"></div>
                                </div>
                            </div>
                            <div class="col-md-4 form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">客户</span>
                                    <div style="height: 34px;"><input id="clientname" placeholder="请填写客户"></div>
                                </div>
                            </div>
                            <div class="col-md-4 form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">追溯码</span>
                                    <input type="text" class="form-control disinp" placeholder="请填写追溯码" id="logisticsNumber">
                                </div>
                            </div>
                            <div class="col-md-4 form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">国家</span>
                                    <input type="text" class="form-control disinp" placeholder="请填写国家" id="country">
                                </div>
                            </div>
                            <div class="col-md-4 form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">运输方式</span>
                                    <select id="gotype" class="form-control disinp">
                                        <option value="1">空运</option>
                                        <option value="2">海运</option>
                                        <option value="3">铁运</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-12 form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">地址</span>
                                    <input type="text" class="form-control disinp" placeholder="请填写地址" id="address">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="box-header">
                        <h3 class="box-title">配送信息</h3>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">
                        <div class="row">
                            <div class="col-md-4 form-group">
                                <div class="input-group date">
                                    <div class="input-group-addon">
                                        <span>出库时间</span>
                                    </div>
                                    <input type="text" class="form-control pull-right disinp1" placeholder="请填写出库时间" id="outwarehouse">
                                </div>
                            </div>
                            <div class="col-md-4 form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">提单号</span>
                                    <input type="text" class="form-control disinp1" placeholder="请填写提单号" id="blno">
                                </div>
                            </div>
                            <div class="col-md-4 form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">运输方式</span>
                                    <select class="form-control disinp1" id="shiptype" onchange="chosefs();">
                                        <option value="">请选择运输方式</option>
                                        <option value="海运">海运</option>
                                        <option value="空运">空运</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4 form-group" id="chuanming"  style="display: none;">
                                <div class="input-group">
                                    <span class="input-group-addon">船名</span>
                                    <input type="text" class="form-control disinp1" placeholder="请填写船名" id="vesselname">
                                </div>
                            </div>
                            <div class="col-md-4 form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">起始地</span>
                                    <input type="text" class="form-control disinp1" placeholder="请填写起始地" id="portloading">
                                </div>
                            </div>
                            <div class="col-md-4 form-group">
                                <div class="input-group date">
                                    <div class="input-group-addon">
                                        <span>预计起运</span>
                                    </div>
                                    <input type="text" class="form-control pull-right disinp1" placeholder="请填写预计起运" id="shipetd">
                                </div>
                            </div>
                            <div class="col-md-4 form-group">
                                <div class="input-group date">
                                    <div class="input-group-addon">
                                        <span>实际起运</span>
                                    </div>
                                    <input type="text" class="form-control pull-right disinp1" placeholder="请填写实际起运" id="shipatd">
                                </div>
                            </div>
                            <div class="col-md-4 form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">目的地</span>
                                    <input type="text" class="form-control disinp1" placeholder="请填写目的地" id="shipportdischarge">
                                </div>
                            </div>
                            <div class="col-md-4 form-group">
                                <div class="input-group date">
                                    <div class="input-group-addon">
                                        <span>预计到达</span>
                                    </div>
                                    <input type="text" class="form-control pull-right disinp1" placeholder="请填写预计到达" id="shipeta">
                                </div>
                            </div>
                            <div class="col-md-4 form-group">
                                <div class="input-group date">
                                    <div class="input-group-addon">
                                        <span>实际到达</span>
                                    </div>
                                    <input type="text" class="form-control pull-right disinp1" placeholder="请填写实际到达" id="shipata">
                                </div>
                            </div>
                            <div class="col-md-4 form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">查验情况</span>
                                    <input type="text" class="form-control disinp1" placeholder="请填写查验情况" id="inspectsituation">
                                </div>
                            </div>
                            <div class="col-md-4 form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">派送公司</span>
                                    <input type="text" class="form-control disinp1" placeholder="请填写派送公司" id="distributecompany">
                                </div>
                            </div>
                            <div class="col-md-4 form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">跟踪号</span>
                                    <input type="text" class="form-control disinp1" placeholder="请填写跟踪号" id="trackingno">
                                </div>
                            </div>
                            <div class="col-md-4 form-group">
                                <div class="input-group date">
                                    <div class="input-group-addon">
                                        <span>预计起运(配送)</span>
                                    </div>
                                    <input type="text" class="form-control pull-right disinp1" placeholder="请填写预计起运" id="distributeETD">
                                </div>
                            </div>
                            <div class="col-md-4 form-group">
                                <div class="input-group date">
                                    <div class="input-group-addon">
                                        <span>实际起运(配送)</span>
                                    </div>
                                    <input type="text" class="form-control pull-right disinp1" placeholder="请填写实际起运" id="distributeATD">
                                </div>
                            </div>
                            <div class="col-md-4 form-group">
                                <div class="input-group date">
                                    <div class="input-group-addon">
                                        <span>预计送达(配送)</span>
                                    </div>
                                    <input type="text" class="form-control pull-right disinp1" placeholder="请填写预计送达" id="distributeETA">
                                </div>
                            </div>
                            <div class="col-md-4 form-group">
                                <div class="input-group date">
                                    <div class="input-group-addon">
                                        <span>实际送达(配送)</span>
                                    </div>
                                    <input type="text" class="form-control pull-right disinp1" placeholder="实际送达" id="distributeATA">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Modal -->
        <div class="modal fade" id="myModalRetract" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="myModalLabelRetract">驳回</h4>
                    </div>
                    <div class="modal-body">
                        <textarea id="rejectremark" style="width:100%;height:200px;"></textarea>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary" onclick="confirm();">确认驳回</button>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <script src="resources/plugins/page/page.js"></script>
    <script src="resources/plugins/sweetalert/sweetalert.min.js"></script>
    <script src="resources/plugins/bootstrap-select-1.12.4/js/bootstrap-select.min.js"></script>
    <script src="resources/js/ajaxfileupload.js" type="text/javascript" charset="utf-8"></script>
    <script src="resources/js/jquery.barcode.js" type="text/javascript" charset="utf-8"></script>
    <script src="resources/plugins/dist/js/standalone/selectize.js"></script>
    <script src="resources/plugins/moment/moment.min.js"></script>
    <script src="resources/plugins/bootstrap-datetimepicker-master/js/bootstrap-datetimepicker.min.js"></script>
    <script src="resources/plugins/bootstrap-datetimepicker-master/js/locales/bootstrap-datetimepicker.zh-CN.js"></script>
    <script th:inline="javascript">//引用
    var boxlist = [];
    var type = /*[[${type}]]*/;//从我的认领页面过来
    var cluid = /*[[${cluid}]]*/;//任务id
    var hid = /*[[${hid}]]*/;//货物id
    $(function(){
        if(type ){
            $("#toupdate").show();
            $("#toRetract").show();
        }

        //提交任务
        $("#toSubmit").on("click",function(){
            toSubmit();
        });

        $("#reject li").on("click",function(){
            $(this).attr("data-click",1);
        })

        $(".disinp").attr("disabled",true);
        $(".disinp1").attr("disabled",true);

        var id = $("#hid").val();
        $.ajax({
            url:'cargo/'+id+'/getcargologisticsbyid',
            type:"post",
            dataType:"json",
            success:function(data){
                var warehouseaddress = data.data.cl.warehouseaddress==null?"":data.data.cl.warehouseaddress;
                var warehouseintime = (data.data.cl.warehouseintime == null||data.data.cl.warehouseintime == ""||data.data.cl.warehouseintime == 'null') ? "" : moment(data.data.cl.warehouseintime).format('YYYY-MM-DD HH:mm:ss');
                var country = data.data.cl.country==null?"":data.data.cl.country;
                var logisticsNumber = data.data.cl.logisticsNumber==null?"":data.data.cl.logisticsNumber;
                var gotype = data.data.cl.gotype==null?"":data.data.cl.gotype;
                $("#address").val(warehouseaddress);
                $("#country").val(country);
                $("#warehouseintime").val(warehouseintime);
                $("#logisticsNumber").val(logisticsNumber);
                $("#boxcount").val(data.data.box.length);
                $("#gotype").val(gotype);
                var list1 = [data.data.cl.wid];
                setlist1(list1);
                var list2 = [data.data.cl.cid];
                list2.push(list2);
                setlist2(list2);

                $("#td0 tbody").empty();
                boxlist = data.data.box;
                for(var i=0;i<data.data.box.length;i++){
                    var sort = data.data.box[i].sort==null?"":data.data.box[i].sort;
                    var weight = data.data.box[i].weight==null?"":data.data.box[i].weight;
                    var size = data.data.box[i].size==null?"":data.data.box[i].size;
                    var place = data.data.box[i].place==null?"":data.data.box[i].place;
                    $("#tb0 > tbody").append('<tr>'+
                            '<td><input type="text" class="form-control" style="padding:0px;border: 0px;text-align: center;" placeholder="请填写序号" value="'+sort+'"></td>'+
                            '<td><input type="text" class="form-control" style="padding:0px;border: 0px;text-align: center;" placeholder="请填写单个SKU重量（KG）" value="'+weight+'"></td>'+
                            '<td><input type="text" class="form-control" style="padding:0px;border: 0px;text-align: center;" placeholder="请填写单个SKU尺寸（CM）" value="'+size+'"></td>'+
                            '<td><input type="text" class="form-control" style="padding:0px;border: 0px;text-align: center;" placeholder="请填写位置" value="'+place+'"></td>'+
                            '</tr>');
                }
                $("#tb0 tbody tr td").find("input").attr("disabled",true);
            }
        });


        $.ajax({
            url:"cargo/"+id+"/getcargooverseasbyid",
            type:"post",
            dataType:"json",
            success:function(data){
                var outwarehouse = (data.data.outwarehouse == null||data.data.outwarehouse == ""||data.data.outwarehouse == 'null') ? "" : moment(data.data.outwarehouse).format('YYYY-MM-DD HH:mm:ss');
                var shipetd = (data.data.shipetd == null||data.data.shipetd == ""||data.data.shipetd == 'null') ? "" : moment(data.data.shipetd).format('YYYY-MM-DD HH:mm:ss');
                var shipatd = (data.data.shipatd == null||data.data.shipatd == ""||data.data.shipatd == 'null') ? "" : moment(data.data.shipatd).format('YYYY-MM-DD HH:mm:ss');
                var shipeta = (data.data.shipeta == null||data.data.shipeta == ""||data.data.shipeta == 'null') ? "" : moment(data.data.shipeta).format('YYYY-MM-DD HH:mm:ss');
                var shipata = (data.data.shipata == null||data.data.shipata == ""||data.data.shipata == 'null') ? "" : moment(data.data.shipata).format('YYYY-MM-DD HH:mm:ss');
                var distributeETD = (data.data.distributeETD == null||data.data.distributeETD == ""||data.data.distributeETD == 'null') ? "" : moment(data.data.distributeETD).format('YYYY-MM-DD HH:mm:ss');
                var distributeATD = (data.data.distributeATD == null||data.data.distributeATD == ""||data.data.distributeATD == 'null') ? "" : moment(data.data.distributeATD).format('YYYY-MM-DD HH:mm:ss');
                var distributeETA = (data.data.distributeETA == null||data.data.distributeETA == ""||data.data.distributeETA == 'null') ? "" : moment(data.data.distributeETA).format('YYYY-MM-DD HH:mm:ss');
                var distributeATA = (data.data.distributeATA == null||data.data.distributeATA == ""||data.data.distributeATA == 'null') ? "" : moment(data.data.distributeATA).format('YYYY-MM-DD HH:mm:ss');
                $("#hhid").val(data.data.id);
                $('#outwarehouse').datetimepicker('update',outwarehouse);
                $("#blno").val(data.data.blno);
                $("#shiptype").val(data.data.shiptype);
                if(data.data.shiptype=="海运"){
                    $("#chuanming").show();
                    $("#vesselname").val(data.data.vesselname);
                }else{
                    $("#chuanming").hide();
                }
                $("#portloading").val(data.data.portloading);
                $('#shipetd').datetimepicker('update',shipetd);
                $('#shipatd').datetimepicker('update',shipatd);
                $("#shipportdischarge").val(data.data.shipportdischarge);
                $('#shipeta').datetimepicker('update',shipeta);
                $('#shipata').datetimepicker('update',shipata);
                $("#inspectsituation").val(data.data.inspectsituation);
                $("#distributecompany").val(data.data.distributecompany);
                $("#trackingno").val(data.data.trackingno);
                $('#distributeETD').datetimepicker('update',distributeETD);
                $('#distributeATD').datetimepicker('update',distributeATD);
                $('#distributeETA').datetimepicker('update',distributeETA);
                $('#distributeATA').datetimepicker('update',distributeATA);
            }
        });

    });

    function setlist1(list1){
        $.ajax({
            url:"warehouseclient/warehouse",
            type:"get",
            data:{},
            dataType:"json",
            success:function(data){
                if(data.statusCode==0){
                    var list = [];
                    for (var i = 0; i < data.data.length; i++) {
                        var demolist = {"id": data.data[i].id, "name": data.data[i].warehouseid};
                        list.push(demolist);
                    }
                    var $select = $('#warehouseid').selectize({
                        createOnBlur: true,
                        maxItems: 1,
                        valueField: 'id',
                        labelField: 'name',
                        searchField: 'name',
                        options: list,
                        create: true
                    });
                    var control = $select[0].selectize;
                    control.setValue(list1);
                    control.disable();
                }
            }
        });
    }

    function setlist2(list2){
        $.ajax({
            url:"warehouseclient/client",
            type:"get",
            data:{},
            dataType:"json",
            success:function(data){
                if(data.statusCode==0){
                    var list = [];
                    for (var i = 0; i < data.data.length; i++) {
                        var demolist = {"id": data.data[i].id, "name": data.data[i].clientname};
                        list.push(demolist);
                    }
                    var $select = $('#clientname').selectize({
                        createOnBlur: true,
                        maxItems: 1,
                        valueField: 'id',
                        labelField: 'name',
                        searchField: 'name',
                        options: list,
                        create: true
                    });
                    var control = $select[0].selectize;
                    control.setValue(list2);
                    control.disable();
                }
            }
        });
    }

    $('#warehouseintime').datetimepicker({
        minuteStep: 1,
        todayBtn: true,
        format:"yyyy-mm-dd hh:ii:ss",
        autoclose:true
    });

    $('#outwarehouse').datetimepicker({
        minuteStep: 1,
        todayBtn: true,
        format:"yyyy-mm-dd hh:ii",
        autoclose:true
    });

    $('#shipetd').datetimepicker({
        minuteStep: 1,
        todayBtn: true,
        format:"yyyy-mm-dd hh:ii",
        autoclose:true
    });

    $('#shipatd').datetimepicker({
        minuteStep: 1,
        todayBtn: true,
        format:"yyyy-mm-dd hh:ii",
        autoclose:true
    });

    $('#shipeta').datetimepicker({
        minuteStep: 1,
        todayBtn: true,
        format:"yyyy-mm-dd hh:ii",
        autoclose:true
    });

    $('#shipata').datetimepicker({
        minuteStep: 1,
        todayBtn: true,
        format:"yyyy-mm-dd hh:ii",
        autoclose:true
    });

    $('#distributeETD').datetimepicker({
        minuteStep: 1,
        todayBtn: true,
        format:"yyyy-mm-dd hh:ii",
        autoclose:true
    });

    $('#distributeATD').datetimepicker({
        minuteStep: 1,
        todayBtn: true,
        format:"yyyy-mm-dd hh:ii",
        autoclose:true
    });

    $('#distributeETA').datetimepicker({
        minuteStep: 1,
        todayBtn: true,
        format:"yyyy-mm-dd hh:ii",
        autoclose:true
    });

    $('#distributeATA').datetimepicker({
        minuteStep: 1,
        todayBtn: true,
        format:"yyyy-mm-dd hh:ii",
        autoclose:true
    });

    function chosefs(){
        var shiptype = $("#shiptype").val();
        if(shiptype=="海运"){
            $("#chuanming").show();
        }else{
            $("#chuanming").hide();
        }
    }


    $("#toupdate").on("click",function(){
        $("#toSubmit").show();
        $("#toRetract").hide();
        $("#toupdate").hide();
        $("#tosave").show();
        $(".disinp1").attr("disabled",false);
    });

    $("#tosave").on("click",function(){
        var id = $("#hhid").val();
        var clid = $("#hid").val();
        var outwarehouse = $("#outwarehouse").val();
        var blno = $("#blno").val();
        var shiptype = $("#shiptype").val();
        var vesselname = $("#vesselname").val();
        var voyno = $("#voyno").val();
        var portloading = $("#portloading").val();
        var shipetd = $("#shipetd").val();
        var shipatd = $("#shipatd").val();
        var shipportdischarge = $("#shipportdischarge").val();
        var shipeta = $("#shipeta").val();
        var shipata = $("#shipata").val();
        var inspectsituation = $("#inspectsituation").val();
        var distributecompany = $("#distributecompany").val();
        var trackingno = $("#trackingno").val();
        var distributeETD = $("#distributeETD").val();
        var distributeATD = $("#distributeATD").val();
        var distributeETA = $("#distributeETA").val();
        var distributeATA = $("#distributeATA").val();
        outwarehouse = (outwarehouse == null||outwarehouse == ""||outwarehouse == 'null') ? "" : moment(outwarehouse).format('YYYY-MM-DD HH:mm:ss');
        shipetd = (shipetd == null||shipetd == ""||shipetd == 'null') ? "" : moment(shipetd).format('YYYY-MM-DD HH:mm:ss');
        shipatd = (shipatd == null||shipatd == ""||shipatd == 'null') ? "" : moment(shipatd).format('YYYY-MM-DD HH:mm:ss');
        shipeta = (shipeta == null||shipeta == ""||shipeta == 'null') ? "" : moment(shipeta).format('YYYY-MM-DD HH:mm:ss');
        shipata = (shipata == null||shipata == ""||shipata == 'null') ? "" : moment(shipata).format('YYYY-MM-DD HH:mm:ss');
        distributeETD = (distributeETD == null||distributeETD == ""||distributeETD == 'null') ? "" : moment(distributeETD).format('YYYY-MM-DD HH:mm:ss');
        distributeATD = (distributeATD == null||distributeATD == ""||distributeATD == 'null') ? "" : moment(distributeATD).format('YYYY-MM-DD HH:mm:ss');
        distributeETA = (distributeETA == null||distributeETA == ""||distributeETA == 'null') ? "" : moment(distributeETA).format('YYYY-MM-DD HH:mm:ss');
        distributeATA = (distributeATA == null||distributeATA == ""||distributeATA == 'null') ? "" : moment(distributeATA).format('YYYY-MM-DD HH:mm:ss');
        var overseasEntity = {
            id:id,
            clid:clid,
            outwarehouse:outwarehouse,
            blno:blno,
            shiptype:shiptype,
            vesselname:vesselname,
            voyno:voyno,
            portloading:portloading,
            shipetd:shipetd,
            shipatd:shipatd,
            shipportdischarge:shipportdischarge,
            shipeta:shipeta,
            shipata:shipata,
            inspectsituation:inspectsituation,
            distributecompany:distributecompany,
            trackingno:trackingno,
            distributeETD:distributeETD,
            distributeATD:distributeATD,
            distributeETA:distributeETA,
            distributeATA:distributeATA,
        };

        console.log(JSON.stringify(overseasEntity));
        $.ajax({
            url:"cargo/createcargooverseasbyclid",
            type:"post",
            data:JSON.stringify(overseasEntity),
            contentType: "application/json",
            success:function(data){
                swal({
                    title: "提示！",
                    text: "已保存任务！",
                    type: "success"
                }, function () {
                    location.href="toClaimList";
                });
            }
        });

    })
    //撤回任务
//    function toDelete(){
//        $.ajax({
//            type: "post",
//            url: "claim/deleteclaim",
//            data: {
//                "clid" : hid,
//                "cluid" : cluid,
//            },
//            dataType: "json",
//            success: function (data) {
//                if (data.statusCode ==1) {
//                    swal("提示!", "已撤回任务！", "success"), function () {
//                        location.href = "toClaimList";
//                    };
//                }
//            },
//            error: function (data) {
//                console.log
//                swal("跳转失败！", data.message, "error");
//            }
//        })
//    }
//
//    //撤回任
//    $("#toDelete").on("click",function(){
//        toDelete();
//    });

    //驳回
    function confirm(){
        var num = 0;
        $("#reject li").each(function(){
            var clickType = $(this).attr("data-click");
            if(clickType == 1){
                num = 1;
                cltype = $(this).attr("data-no");
                $(this).attr("data-click","0");
            }
        })
        if(num == 0){
            return;
        }
        var rejectremark = $("#rejectremark").val();
        $.ajax({
            type: "post",
            url: "claim/rejectclamin",
            data: {
                "clid" : hid,
                "cluid" : cluid,
                "cltype" : cltype,
                "rejectremark" : rejectremark,
            },
            dataType: "json",
            success: function (data) {
                if (data.statusCode == 0) {
                    swal({
                        title: "提示！",
                        text: "已驳回任务！",
                        type: "success"
                    }, function () {
                        location.href="toClaimList";
                    });
                }
            },
            error: function (data) {
                swal("跳转失败！", data.message, "error");
            }
        })
    }

    //提交任务
    function toSubmit(){
        var overseasEntity = getOverseasEntity();
        $.ajax({
            url:"cargo/createcargooverseasbyclid",
            type:"post",
            data:JSON.stringify(overseasEntity),
            contentType: "application/json",
            success:function(data){
                swal({
                    title: "提示！",
                    text: "已提交任务！",
                    type: "success"
                }, function () {
                    location.href="toClaimList";
                });
            }
        });
    }

    function getOverseasEntity(){
        var id = $("#hhid").val();
        var clid = $("#hid").val();
        var outwarehouse = $("#outwarehouse").val();
        var blno = $("#blno").val();
        var shiptype = $("#shiptype").val();
        var vesselname = $("#vesselname").val();
        var voyno = $("#voyno").val();
        var portloading = $("#portloading").val();
        var shipetd = $("#shipetd").val();
        var shipatd = $("#shipatd").val();
        var shipportdischarge = $("#shipportdischarge").val();
        var shipeta = $("#shipeta").val();
        var shipata = $("#shipata").val();
        var inspectsituation = $("#inspectsituation").val();
        var distributecompany = $("#distributecompany").val();
        var trackingno = $("#trackingno").val();
        var distributeETD = $("#distributeETD").val();
        var distributeATD = $("#distributeATD").val();
        var distributeETA = $("#distributeETA").val();
        var distributeATA = $("#distributeATA").val();
        outwarehouse = (outwarehouse == null||outwarehouse == ""||outwarehouse == 'null') ? "" : moment(outwarehouse).format('YYYY-MM-DD HH:mm:ss');
        shipetd = (shipetd == null||shipetd == ""||shipetd == 'null') ? "" : moment(shipetd).format('YYYY-MM-DD HH:mm:ss');
        shipatd = (shipatd == null||shipatd == ""||shipatd == 'null') ? "" : moment(shipatd).format('YYYY-MM-DD HH:mm:ss');
        shipeta = (shipeta == null||shipeta == ""||shipeta == 'null') ? "" : moment(shipeta).format('YYYY-MM-DD HH:mm:ss');
        shipata = (shipata == null||shipata == ""||shipata == 'null') ? "" : moment(shipata).format('YYYY-MM-DD HH:mm:ss');
        distributeETD = (distributeETD == null||distributeETD == ""||distributeETD == 'null') ? "" : moment(distributeETD).format('YYYY-MM-DD HH:mm:ss');
        distributeATD = (distributeATD == null||distributeATD == ""||distributeATD == 'null') ? "" : moment(distributeATD).format('YYYY-MM-DD HH:mm:ss');
        distributeETA = (distributeETA == null||distributeETA == ""||distributeETA == 'null') ? "" : moment(distributeETA).format('YYYY-MM-DD HH:mm:ss');
        distributeATA = (distributeATA == null||distributeATA == ""||distributeATA == 'null') ? "" : moment(distributeATA).format('YYYY-MM-DD HH:mm:ss');
        var overseasEntity = {
            id:id,
            clid:clid,
            outwarehouse:outwarehouse,
            blno:blno,
            shiptype:shiptype,
            vesselname:vesselname,
            voyno:voyno,
            portloading:portloading,
            shipetd:shipetd,
            shipatd:shipatd,
            shipportdischarge:shipportdischarge,
            shipeta:shipeta,
            shipata:shipata,
            inspectsituation:inspectsituation,
            distributecompany:distributecompany,
            trackingno:trackingno,
            distributeETD:distributeETD,
            distributeATD:distributeATD,
            distributeETA:distributeETA,
            distributeATA:distributeATA,
            agressmessage : 1,//1:提交  null 创建/保存
        };
        return overseasEntity;
    }
    </script>
</div>

</body>

</html>