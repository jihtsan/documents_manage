<!DOCTYPE html>
<html lang="en" xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
      layout:decorator="common/layout" xmlns:th="http://www.w3.org/1999/xhtml" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8"/>
    <title>AlphaZ</title>
    <link rel="stylesheet" href="resources/plugins/datatables/dataTables.bootstrap.css"/>
    <link rel="stylesheet" href="resources/plugins/bootstrap-select-1.12.4/css/bootstrap-select.min.css"/>
    <link rel="stylesheet" href="resources/plugins/sweetalert/sweetalert.css">
    <!--<link rel="stylesheet" href="resources/plugins/datepicker/datepicker3.css">-->
    <link rel="stylesheet" href="resources/plugins/dist/css/selectize.default.css">
    <link rel="stylesheet" href="resources/plugins/bootstrap-datetimepicker-master/css/bootstrap-datetimepicker.min.css">
    <style>
        .waring{
            border:2px solid red;
        }
    </style>
</head>
<body>
<div layout:fragment="content">
    <section class="content-header">
        <h1>
            查看/编辑用户信息
            <small></small>
        </h1>
        <button class="btn btn-primary" style="float: right;margin-top: -20px;margin-bottom: 5px;display: none;" id="toupdate">编辑</button>
        <button class="btn btn-primary" style="float: right;margin-top: -20px;margin-bottom: 5px;display: none;" id="tosave">保存</button>
    </section>
    <section class="content">
        <img class='img_close' src='resources/img/clone.png' style="display: none">
        <div class="row">
            <div class="col-xs-12">
                <div class="box">
                    <div class="box-header">
                        <h3 class="box-title">用户信息</h3>
                        <!--<ul class="nav navbar-right panel_toolbox">
                            <li><a href="tocargolist" style="margin-right:10px;"><i class="fa fa-arrow-left"></i>返回</a>
                            </li>
                        </ul>-->
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">
                        <div class="form-group row">
                            <div class="col-md-4">
                                <div class="input-group">
                                    <span class="input-group-addon">用户名称</span>
                                    <input type="text" class="form-control disinp" placeholder="请填写用户名称" id="username">
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-md-4">
                                <div class="input-group">
                                    <span class="input-group-addon">真实姓名</span>
                                    <input type="text" class="form-control disinp" placeholder="请填写用户名称" id="note">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <script src="resources/plugins/page/page.js"></script>
    <script src="resources/plugins/sweetalert/sweetalert.min.js"></script>
    <script src="resources/plugins/bootstrap-select-1.12.4/js/bootstrap-select.min.js"></script>
    <script src="resources/js/ajaxfileupload.js" type="text/javascript" charset="utf-8"></script>
    <script src="resources/js/jquery.barcode.js" type="text/javascript" charset="utf-8"></script>
    <!--<script src="resources/plugins/datepicker/bootstrap-datepicker.js"></script>-->
    <!-- <script src="resources/plugins/datepicker/locales/bootstrap-datepicker.zh-CN.js"></script>-->
    <script src="resources/plugins/dist/js/standalone/selectize.js"></script>
    <script src="resources/plugins/bootstrap-datetimepicker-master/js/bootstrap-datetimepicker.min.js"></script>
    <script src="resources/plugins/bootstrap-datetimepicker-master/js/locales/bootstrap-datetimepicker.zh-CN.js"></script>
    <script src="resources/plugins/moment/moment.min.js"></script>

    <script th:inline="javascript">//引用
    var userId = /*[[${userId}]]*/;//任务id
    $(function(){
        $("#toupdate").show();
        $(".disinp").attr("disabled",true);

        $("input").blur(function(){
            if($(this).val() != ""){
                $(this).removeClass("waring");
            }
        })
        var note = $("#note").val();
        var username = $("#username").val();
        $.ajax({
            type: "post",
            url: "user/" + userId + "/getuserinf",
            dataType: "json",
            success: function (data) {
                console.log("数据...")
                console.log(data)
                template(data.data);
            },
            error: function () {
                swal("跳转失败！", "跳转失败。", "error");
            }
        })

    });

    function pageNo(){

    }

    function template(data){
        var note = data.note;
        var username = data.username;
        $("#note").val(note);
        $("#username").val(username);
    }

    $("#toupdate").on("click",function(){
        $("#toupdate").hide();
        $("#tosave").show();
        $(".disinp").attr("disabled",false);
        $("#setbox").show();
        $("#tb0 tbody tr td").find("input").attr("disabled",false);
    });

    $("#tosave").on("click",function(){
        var note = $("#note").val();
        var username = $("#username").val();
        var num = 0;
        if(!username || username == ""){
            $("#username").addClass("waring");
            num = 1;
        }
        if(!note || note == ""){
            $("#note").addClass("waring");
            num = 1;
        }
        if(num == 1){
            return;
        }
        $.ajax({
            type: "post",
            url: "user/createuser",
            data: {
                "id": userId,
                "note" : note,
                "username": username,
                "status" : 0,
            },
            dataType: "json",
            success: function (data) {
                swal({
                    title: "提示！",
                    text: "修改成功！",
                    type: "success"
                }, function () {
                    location.href = "toUserList";
                })
            },
            error: function () {
                swal("提示！", "创建失败。", "error");
            }
        })

    })



    </script>
</div>

</body>

</html>